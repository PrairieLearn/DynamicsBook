<?xml version="1.0"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <title>
      Shortest flight paths
    </title>
    <link href="style.css" type="text/css" rel="stylesheet" />
    <link href="aos.css" type="text/css" rel="stylesheet" />
    <link href="icomoon.css" type="text/css" rel="stylesheet" />

    <script src=
            "mathjax/MathJax.js?config=default"
            type="text/javascript">
            </script>
            <script src="jquery-1.7.2.min.js" type="text/javascript">
            </script>
            <script src="sylvester.js" type="text/javascript">
            </script>
            <script src="sha1.js" type="text/javascript">
            </script>
            <script src="PrairieDraw.js" type="text/javascript">
            </script>
            <script src="aos.js" type="text/javascript"></script>
            <script src="pageControl.js" type="text/javascript">
            </script>
  </head>
  <body>
    <div class="contentBlock">
      <div id="aos" class="contentCol">
        <h1>Shortest flight paths</h1>
        <p>
          See <a
          href="http://www.fourmilab.ch/earthview/">earthview</a> for
          globe images. Try NASA Blue Marble from 35° N, 50° W.
        </p>
        <p>
          Can also buy imagery from <a
          href="http://www.earth-images.com/contents.htm">Planetary
          Visions</a>.
        </p>
      </div>
      <div class="infoCol">
        <div id="avs-ip" class="infoBox factBox">
          Map projections.
        </div>
        <div id="avs-ij" class="infoBox factBox">
          J2 effect, spherical harmonics to model Earth shape.
        </div>
      </div>
    </div>
    <div class="contentBlock">
      <div id="aos-sp" class="contentCol">
        <h2>Diagram</h2>
        <div class="figureContainer" id="aos-fd">
          <canvas id="aos-fd-c" width="600" height="600">
          </canvas>
          <p>
            Show:
            <button class="option-toggle:aos-fd-c:showLabels">labels</button>
            <button class="option-toggle:aos-fd-c:showLatLongLines">latitude/longitude grid</button>
            <button class="option-toggle:aos-fd-c:showCityGreatCircle">great circle between cities</button>
            <button class="option-toggle:aos-fd-c:showCityPositionVectors">city position vectors</button>
            <button class="option-toggle:aos-fd-c:showCityLatLong">city latitude and longitude</button>
          </p>
          <table>
            <tr>
              <td>Earth transparency:</td>
              <td><input type="range" min="0" max="100" value="0" step="1" class="data-input:aos-fd-c:sphereTransPerc" /></td>
              <td><span class="data-option:aos-fd-c:sphereTransPerc"></span>%</td>
            </tr>
            <tr>
              <td>City 1 Latitude:</td>
              <td><input type="range" min="-90" max="90" value="0" step="1" class="data-input:aos-fd-c:latitudeDeg1" /></td>
              <td>$\phi_1 = $ <span class="data-option:aos-fd-c:latitudeDeg1"></span>°</td>
            </tr>
            <tr>
              <td>City 1 Longitude:</td>
              <td><input type="range" min="-180" max="180" value="0" step="1" class="data-input:aos-fd-c:longitudeDeg1" /></td>
              <td>$\lambda_1 = $ <span class="data-option:aos-fd-c:longitudeDeg1"></span>°</td>
            </tr>
            <tr>
              <td>City 2 Latitude:</td>
              <td><input type="range" min="-90" max="90" value="0" step="1" class="data-input:aos-fd-c:latitudeDeg2" /></td>
              <td>$\phi_1 = $ <span class="data-option:aos-fd-c:latitudeDeg2"></span>°</td>
            </tr>
            <tr>
              <td>City 2 Longitude:</td>
              <td><input type="range" min="-180" max="180" value="0" step="1" class="data-input:aos-fd-c:longitudeDeg2" /></td>
              <td>$\lambda_1 = $ <span class="data-option:aos-fd-c:longitudeDeg2"></span>°</td>
            </tr>
          </table>
        </div>
      </div>
    </div>
    <div class="contentBlock">
      <div id="aos-sp" class="contentCol">
        <h2>Proof that great circles are shortest paths</h2>
        <p>
          Use spherical coordinates with $\theta$ the angle around the
          equator (longitude) and $\phi$ the angle up from the equator
          (latitude).
        </p>
        <p>
          Choose coordinates so that the two points are $A$ at $(r =
          r_0, \theta = 0, \phi = -\phi_0)$ and $B$ at $(r = r_0,
          \theta = 0, \phi = \phi_0)$, with $r_0$ being the radius of
          the Earth and $0 \le \phi_0 \le \pi/2$.
        </p>
        <p>
          Assume that the path from the first point to the second lies
          on the Earth's surface and can be parameterized by $\phi$
          going from $-\phi_0$ to $\phi_0$ with $r = r_0$ and $\theta
          = \theta(\phi)$ for a differentiable function
          $\theta(\phi)$.
        </p>
        <p>
          Use the rectangular coordinate conversion:
        </p>
        <p>
          \[\begin{aligned}
          x &amp;= r \cos\theta \cos\phi \\
          y &amp;= r \sin\theta \cos\phi \\
          z &amp;= r \sin\phi.
          \end{aligned}\]
        </p>
        <p>
          Compute the arc length:
        </p>
        <p>
          \[
          L = \int_A^B \sqrt{dx^2 + dy^2 + dz^2}
          = \int_{-\phi_0}^{\phi_0} r_0 \sqrt{1 + \frac{1 + \cos 2\phi}{2}
          \left(\frac{\partial\theta}{\partial\phi}\right)^2} d\phi.
          \]
        </p>
        <p>
          Now for $0 \le \phi_0 \lt \pi/2$ we know that $(1 + \cos
          2\phi)/2$ is positive, and so the path length is minimized
          when $\partial\theta/\partial\phi = 0$ along the path. Given
          that we start and end with $\theta = 0$, we have that
          $\theta = 0$ along the path and so the minimum path length
          is given by the great circle with $\theta = 0$. If $\phi_0 =
          \pi/2$ then we could allow any initial and final $\theta$,
          so $\partial\theta/\partial\phi = 0$ would imply that
          $\theta$ is constant along the path, giving one of the other
          great circles joining the two poles.
        </p>
      </div>
    </div>
    <div class="contentBlock">
      <div id="aos-so" class="contentCol">
        <h2>Old stuff</h2>
        <p>Take lat/long for Urbana and Shanghai:</p>
        <p>\[\begin{aligned}
        \text{Urbana: } &amp;40.109665^\circ\text{N}, 88.204247^\circ\text{W} \\
        \text{Shanghai: } &amp;31.2^\circ\text{N}, 121.5^\circ\text{E}\end{aligned}\]</p>
        <p>Write as coordinates:</p>
        <p>\[\begin{aligned}
        \lambda_{\rm U} &amp;= \ldots \\
        \phi_{\rm U} &amp;= \ldots \\
        \lambda_{\rm S} &amp;= \ldots \\
        \phi_{\rm S} &amp;= \ldots\end{aligned}\]</p>
        <p>Convert to Cartesian:</p>
        <p>\[\begin{aligned}
        x_{\rm U} &amp;= \ldots \\
        y_{\rm U} &amp;= \ldots \\
        z_{\rm U} &amp;= \ldots\end{aligned}\]</p>
        <p>The position vectors from the center of the Earth are:</p>
        <p>\[\begin{aligned}
        \overrightarrow{OU} &amp;= \ldots \,\hat{\imath} + \ldots \,\hat{j} + \ldots \,\hat{k} \\
        \overrightarrow{OS} &amp;= \ldots \,\hat{\imath} + \ldots \,\hat{j} + \ldots \,\hat{k}\end{aligned}\]</p>
        <p>These two points define a great circle on the sphere. The shortest path is along this great circle. The angle \(\theta\) within the great circle can be found with the dot product formula VT.DP. Then the arc length is \(R_{\rm E} \theta\).</p>
        <p>Further questions:</p>
        <ol>
          <li><p>What is the maximum latitude reached if we fly along a great circle from Chicago to Shanghai? Find latitude as a function of longitude along this path and plot it on a 2D map of the earth.</p></li>
          <li><p>A better model of the Earth is an ellipsoid, satisfying \((x/6378)^2 + (y/6378)^2 + (z/6357)^2 = 1\) (in km). How could we compute distances on an ellipsoid? This is hard. See <a href="https://en.wikipedia.org/wiki/Vincenty%27s_formulae"><code class="url">https://en.wikipedia.org/wiki/Vincenty%27s_formulae</code></a> for one answer.</p></li>
        </ol>
      </div>
    </div>
  </body>
</html>
